ORG    0000H
LJMP   MAIN
ORG    0003H
LCALL  LOOP
           RETI
ORG    0100H
MAIN:  SETB EA
            SETB EX0
            SETB IT0

LOOP:
      JNB  P0.0,K1
      JNB  P0.1,K2
      JNB  P0.2,K3
      JNB  P0.3,K4
      JNB  P0.4,K5
      JNB  P0.5,K6
      JNB  P0.6,K7
      JNB  P0.7,K8   
      LJMP J0
      RET
K1: CLR P1.0
      MOV 39H,#30
      RET
K2: CLR P1.1
   MOV 40H,#60
    RET
K3: CLR P1.2
    MOV 41H,#90
    RET
K4: CLR P1.3
    MOV 42H,#120
    RET
K5: CLR P1.4
    MOV 43H,#120
    RET
K6: CLR P1.5
    MOV 44H,#90
    RET
K7: CLR P1.6
    MOV 45H,#60
    RET
K8: CLR P1.7
    MOV 46H,#30
    RET

J0:LCALL DL100ms
J1:DJNZ 39H,J2
     SETB P1.0
J2:DJNZ 40H,J3
     SETB P1.1
J3:DJNZ 41H,J4
     SETB P1.2
J4:DJNZ 42H,J5
     SETB P1.3
J5:DJNZ 43H,J6
     SETB P1.4
J6:DJNZ 44H,J7
    SETB P1.5
J7:DJNZ 45H,J8
    SETB P1.6
J8:DJNZ 46H,J0
    SETB P1.7

DL100ms: PUSH 30H
MOV 30H, #100
D100: LCALL DL1MS
DJNZ 30H, D100
POP 30H
RET

DL1MS:  PUSH 30H
MOV 30H, #248
D1: NOP
NOP
DJNZ 30H, D1
POP 30H
RET

END
