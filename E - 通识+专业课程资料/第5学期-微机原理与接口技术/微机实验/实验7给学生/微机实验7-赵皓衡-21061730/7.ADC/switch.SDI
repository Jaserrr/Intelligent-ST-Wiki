,,,;±¾³ÌÐòÍê³ÉÎÂ¶È²É¼¯²¢ÔÚ×î×ó±ßµÄ2Ö»ÊýÂë¹ÜÏÔÊ¾ÎÂ¶ÈÖµ
,,,
,,,LEDSCAN         EQU 30H  ; LEDÊýÂë¹ÜÉ¨ÃèÂëµ¥Ôª
,,,LED_D0          EQU 50H  ; 8¸öLEDÊýÂë¹ÜÊý¾Ý»º´æÆ÷
,,,LED_D1          EQU 51H
,,,LED_D2          EQU 52H
,,,LED_D3          EQU 53H
,,,LED_D4          EQU 54H
,,,LED_D5          EQU 55H
,,,LED_D6          EQU 56H
,,,LED_D7          EQU 57H
,,,TDATA_H16       EQU 40H  ; ÎÂ¶ÈÊ®Áù½øÖÆÖµ
,,,T_NUM           EQU 41H  ; ¶¨Ê±Ñ­»·´ÎÊý
000B,,,ADC_STAR        BIT P2.2 ;  ADÆô¶¯Î»
000B,,,ADC_RD          BIT P2.1 ;  ADÖµ¶ÁÈ¡¿ØÖÆÎ»
000B,,,ADC_EOC         BIT P3.4 ;  AD×ª»»Íê±Ï²éÑ¯Î»
000B,,,LEDSEG_LE       BIT P2.6 ; LEDÊýÂë¹Ü¶ÎÊý¾ÝËø´æÎ»
000B,,,BITSAN_LE       BIT P2.7 ; LEDÊýÂë¹Ü»ò°´Å¥Î»É¨ÃèÊý¾ÝËø´æÎ»
,,,
,,,
,,,
,,,                        ORG             0000H
0000,21 00,,                        AJMP    MAIN
,,,
,,,                        ORG     000BH                           ;¶¨Ê±Æ÷0  ÓÃÓÚLED×´Ì¬±ä»¯ AD²ÉÑù
000B,21 AD,,                        AJMP    TIME0
,,,
,,,                ORG     0100H
0100,75 81 60,MAIN,MAIN:           MOV     SP,#60H
0103,75 89 01,,                MOV     TMOD,#01H                       ;¶¨Ê±Æ÷0¹¤×÷·½Ê½1
0106,75 8A DC,,                MOV     TL0,#0DCH           ;×°ÔØ¼ÆÊý³õÖµ
0109,75 8C 0B,,                MOV     TH0,#0BH            ;Ã¿´ÎÑ­»·125ms
,,,
010C,D2 8C,,                SETB    TR0                 ;¿ªÆô¶¨Ê±Æ÷0
010E,D2 A9,,                SETB    ET0                 ;ÔÊÐí¶¨Ê±0ÖÐ¶Ï
0110,D2 AF,,                SETB    EA
,,,
,,,
0112,75 40 19,,                MOV     TDATA_H16,#25           ;µ±Ç°²âµÃµÄÎÂ¶ÈÖµ,´Ë³õ¸³Öµ32¶È£¬Êµ¼ÊÃ»ÓÐÒâÒå,ÒòÎª³ÌÐ
0115,75 41 08,,                MOV     T_NUM,#08H          ;125ms»ù±¾¶¨Ê±Ñ­»·´ÎÊý
0118,C2 A1,,                        CLR     ADC_RD                          ; ADÊý¾Ý¶ÁÈ¡ÎÞÐ§
011A,C2 A2,,                        CLR     ADC_STAR                        ; ADÆô¶¯ÎÞÐ§
,,,
011C,31 22,HERE,HERE:           ACALL   SHOW
011E,31 40,,                ACALL   DISP
0120,80 FA,,                JMP     HERE
,,,
,,,
,,,
0122,,SHOW,SHOW:
0122,E5 40,,                MOV     A,TDATA_H16                     ;TDATA_H16Àï·Å×ÅÊµ¼ÊÎÂ¶È
0124,75 F0 0A,,                MOV     B,#0AH                          ;²ðÊý×Ö
0127,84,,                DIV     AB
0128,F5 50,,                MOV     LED_D0,A                        ;Ê®Î»ËÍ54H
012A,85 F0 51,,                MOV     LED_D1,B                        ;¸öÎ»ËÍ55H
012D,75 52 10,,                        MOV     LED_D2, #10H            ;ÓÒ±ß6¸öLED²»ÏÔÊ¾
0130,75 53 10,,                MOV     LED_D3, #10H
0133,75 54 10,,                        MOV     LED_D4, #10H
0136,75 55 10,,                MOV     LED_D5, #10H
0139,75 56 10,,                        MOV     LED_D6, #10H
013C,75 57 10,,                        MOV     LED_D7, #10H
013F,22,,                RET
,,,
,,,
0140,C0 83,DISP,DISP:           PUSH    DPH
0142,C0 82,,                PUSH    DPL
0144,C0 D0,,                PUSH    PSW
0146,C0 E0,,                PUSH    ACC
0148,78 50,,                MOV     R0, #LED_D0                     ;ÏÔÊ¾»º³åµ¥ÔªÊ×µØÖ·
014A,75 30 FE,,                MOV     LEDSCAN, #0FEH          ;Î»¿ØÂë
014D,,LD0,LD0:
014D,75 80 FF,,                MOV     P0,#0FFH                ;ÇåÎ»¿Ø¿Ú
0150,D2 A7,,                SETB    BITSAN_LE                       ; LEDÊýÂë¹Ü»ò°´Å¥Î»É¨ÃèÊý¾ÝËø´æÎ»
0152,00,,                NOP
0153,C2 A7,,                CLR     BITSAN_LE
0155,90 01 90,,                MOV     DPTR, #TABLE            ;²é¶ÎÂë
0158,E6,,                MOV     A, @R0
0159,93,,                MOVC    A, @A+DPTR
015A,F5 80,,                        MOV     P0,A                    ;ËÍ¶ÎÂë
015C,D2 A6,,                SETB    LEDSEG_LE                       ; LEDÊýÂë¹Ü¶ÎÊý¾ÝËø´æÎ»
015E,00,,                NOP
015F,C2 A6,,                CLR     LEDSEG_LE
0161,E5 30,,                MOV     A, LEDSCAN
0163,F5 80,,                MOV     P0,A                    ;ËÍÎ»¿ØÂë
0165,D2 A7,,                        SETB    BITSAN_LE                       ; LEDÊýÂë¹Ü»ò°´Å¥Î»É¨ÃèÊý¾ÝËø´æÎ»
0167,00,,                NOP
0168,C2 A7,,                CLR     BITSAN_LE
016A,31 A4,,                ACALL   DELAY
016C,08,,                INC     R0
016D,E5 30,,                MOV     A, LEDSCAN
016F,30 E7 05,,                JNB     ACC.7,LD1
0172,23,,                RL      A
0173,F5 30,,                MOV     LEDSCAN, A
0175,21 4D,,                AJMP    LD0
0177,75 80 00,LD1,LD1:            MOV     P0,#00                  ;Çå¶Î¿Ø¿Ú,ÐÞ¸Ä
017A,D2 A6,,                SETB    LEDSEG_LE                       ; LEDÊýÂë¹Ü¶ÎÊý¾ÝËø´æÎ»
017C,00,,                NOP
017D,C2 A6,,                CLR     LEDSEG_LE
017F,75 80 FF,,                MOV     P0,#0FFH                ;ÇåÎ»¿Ø¿Ú
0182,D2 A7,,                        SETB    BITSAN_LE                       ; LEDÊýÂë¹Ü»ò°´Å¥Î»É¨ÃèÊý¾ÝËø´æÎ»
0184,00,,                NOP
0185,C2 A7,,                CLR     BITSAN_LE
0187,D0 E0,,                POP     ACC
0189,D0 D0,,                POP     PSW
018B,D0 82,,                POP     DPL
018D,D0 83,,                POP     DPH
018F,22,,                RET
,,,
0190,3F 06 5B 4F,TABLE,TABLE:          DB 3FH,06H,5BH,4FH,66H     ; 0    1    2   3   4
0195,6D 7D 07 7F,,                DB 6DH,7DH,07H,7FH,6FH     ; 5    6    7   8   9
019A,77 7C 39 5E,,                DB 77H,7CH,39H,5EH,79H     ; A    B    C   D   E
019F,71 00 76 38,,                DB 71H,00H,76H,38H,40H     ; F    Ãð     H   L   -
,,,
01A4,79 02,DELAY,DELAY:          MOV     R1,#02H            ;ÑÓÊ±Ô¼1ms
01A6,7A 00,DEL0,DEL0:           MOV     R2, #00H
01A8,DA FE,DEL1,DEL1:           DJNZ    R2, DEL1
01AA,D9 FA,,                DJNZ    R1, DEL0
01AC,22,,                RET
,,,
,,,
,,,
01AD,,TIME0,TIME0:
01AD,C0 83,,                PUSH    DPH
01AF,C0 82,,                PUSH    DPL
01B1,C0 E0,,                PUSH    ACC
01B3,C0 D0,,                PUSH    PSW
01B5,75 8A DC,,                MOV     TL0,#0DCH
01B8,75 8C 0B,,                MOV     TH0,#0BH
01BB,E5 41,,                MOV     A,T_NUM
01BD,14,,                DEC     A
01BE,F5 41,,                MOV     T_NUM,A
01C0,70 20,,                JNZ     RET0
01C2,75 41 08,,                MOV     T_NUM,#08H
01C5,75 90 00,,                MOV     P1,#00H             ;Æô¶¯IN0Í¨µÀ
01C8,D2 A2,,                SETB    ADC_STAR
01CA,00,,                        NOP
01CB,C2 A2,,                CLR     ADC_STAR
01CD,,WW,WW:
01CD,30 B4 FD,,                JNB     ADC_EOC,WW              ; ²éÑ¯×ª»¯½á¹û,ÕâÀïÒ²¿ÉÒÔÊ¹ÓÃÈí¼þÑÓÊ±100ms£¬ÒÔ±ÜÃâËÀ
01D0,D2 A1,,                SETB    ADC_RD
01D2,00,,                NOP
01D3,75 90 FF,,                MOV     P1,#0FFH            ; ¶ÁÊý¾ÝÇ°ÏÈÐ´Èë¸ßµçÆ½
01D6,E5 90,,                        MOV     A,P1
01D8,C2 A1,,                        CLR     ADC_RD
01DA,94 22,,                SUBB    A,#22H                  ; ¼õÆ«ÒÆ24
01DC,90 01 EB,,                MOV     DPTR,#TEM_TAB
01DF,93,,                MOVC    A,@A+DPTR
01E0,F5 40,,                MOV     TDATA_H16,A
,,,
01E2,D0 D0,RET0,RET0:           POP     PSW
01E4,D0 E0,,                POP     ACC
01E6,D0 82,,                POP     DPL
01E8,D0 83,,                POP     DPH
01EA,32,,                RETI
,,,
01EB,63 61 5F 5D,TEM_TAB,TEM_TAB:        DB     63H,61H,5FH,5DH,5CH,5AH,59H,58H,56H,55H,54H,52H,51H,50H,4FH,4EH
01FB,4D 4C 4B 4A,,                DB     4DH,4CH,4BH,4AH,49H,48H,47H,46H,45H,44H,43H,42H,41H,41H,40H,3FH
020B,3E 3E 3D 3C,,                DB     3EH,3EH,3DH,3CH,3BH,3AH,3AH,39H,38H,38H,37H,37H,36H,35H,34H,34H
021B,33 33 32 32,,                DB     33H,33H,32H,32H,31H,30H,30H,2FH,2EH,2EH,2DH,2DH,2CH,2CH,2BH,2BH
022B,2A 2A 29 29,,                DB     2AH,2AH,29H,29H,28H,28H,27H,27H,26H,26H,25H,25H,24H,24H,23H,23H
023B,22 22 21 21,,                DB     22H,22H,21H,21H,20H,20H,1FH,1FH,1EH,1EH,1EH,1DH,1DH,1CH,1CH,1BH
024B,1B 1B 1A 1A,,                DB     1BH,1BH,1AH,1AH,19H,19H,18H,18H,18H,17H,17H,16H,16H,15H,15H,15H
025B,15 15 13 13,,                DB     15H,15H,13H,13H,12H,12H,12H,11H,11H,10H,10H,0FH,0FH,0FH,0EH,0EH
026B,0D 0D 0C 0C,,                DB     0DH,0DH,0CH,0CH,0CH,0BH,0BH,0AH,0AH,0AH,09H,09H,08H,08H,08H,07H
027B,07 06 06 05,,                DB     07H,06H,06H,05H,05H,04H,04H,04H,03H,03H,02H,02H,01H,01H,00H,00H
,,,
,,,
000E,,,END
,,,
,,,
,,,
